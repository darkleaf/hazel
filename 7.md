Certainly! Below is a revised version of your project's Readme that aligns with the style of technical documents like those for Clojure or Datomic. It emphasizes clarity, precision, and a professional tone, while ensuring coherence and readability throughout.

---

# Hazel

Hazel is a proof of concept (POC) that explores how the principles of [Datomic](https://www.datomic.com/) can be adapted for frontend environments. It introduces a peer library, crafted in JavaScript, capable of navigating a [DataScript](https://github.com/tonsky/datascript/) database and efficiently caching its segments in the browser.

## Motivation

Modern productivity tools like Asana, Jira, Slack, and Notion require fast, seamless data access directly within the browser, especially when handling relatively large datasets. By leveraging Datomic-like methodologies, Hazel enables fast, local query processing without constant backend interaction, aligning with the demands of contemporary web applications.

Hazel is built upon the React TodoMVC framework.

## Key Features

- **On-Demand Fetching**: Implements lazy iteration over databases by retrieving database segments as needed from the backend.
- **Long-Term Caching**: Stores database segments within the browser's cache for improved performance and offline access.
- **Consistent Snapshots**: Ensures coherent and stable database snapshots at any given point in time.

This infrastructure is especially useful for applications needing instantaneous data access without server roundtrips.

## Core Concepts

For those unfamiliar with Datomic-like systems, consider traditional databases like PostgreSQL or MySQL. These systems handle data on the server and process queries server-side. In contrast, Datomic-like systems allow query execution within your application using local cache, enhancing performance and efficiency.

### How Does It Work?

Familiarity with the DataScript or Datomic data model is recommended. If needed, refer to:

- [Information Model](https://docs.datomic.com/datomic-overview.html#information-model)
- [Indexes](https://docs.datomic.com/datomic-overview.html#indexes)

A DataScript database operates using datoms—triples of [entity, attribute, value] (E, A, V)—stored across three key indices: EAV, AEV, and AVE. While DataScript also includes a Transaction ID (T), Hazel does not utilize it.

The indices in Hazel are implemented as persistent B+ trees, where each node represents a storage segment saved in the browser cache. Utilizing asynchronous generators (`AsyncGenerator`) akin to Clojure's lazy sequences, Hazel efficiently fetches and traverses these segments.

### Database Indexing

- **Branch Nodes**: Navigate using ordered keys and addresses.
- **Leaf Nodes**: Store ordered sequences of datoms.

Hazel's API, reminiscent of low-level Datomic methods, includes:

- `seek-datoms`
- `datoms`

Both methods return lazy, asynchronous sequences, supporting efficient network-bound segment retrieval.

## Limitations

Currently, Hazel implements only the `(r)seek` and `datoms` methods over indices. A notable challenge is managing access control; for instance, granting access to external collaborators without compromising data privacy.

Potential Solutions:

- An additional API for backend query execution, mitigating privacy concerns at the cost of caching.
- Data replication across project-specific databases.

Feedback and ideas are encouraged; please open issues in this repository.

## Future Work

Potential developments include implementing [datalog](https://docs.datomic.com/query/query-executing.html) queries and other Datomic/DataScript APIs. Hazel's approach could be adapted to support local-first paradigms or implement Conflict-free Replicated Data Types (CRDT) directly on the frontend.

## How to Run

```bash
docker build -t hazel . && docker run --rm -p 8080:8080 hazel
```

Access at [http://localhost:8080](http://localhost:8080).

## Development

```bash
bun run test
```

Note: Bun's builder is currently in beta and has some limitations, such as needing to manually reload configurations and lacking automatic `manifest.json` generation.

---

This revised Readme provides a structured, comprehensive, and engaging overview of Hazel, tailored to resonate with both developers and stakeholders.
