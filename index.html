<script type="module">

  async function fetchNode(address) {
    //console.log(address)
    const resp = await fetch("http://localhost:8080/" + address, {
      method: 'GET',
      cache: 'force-cache',
      priority: 'high'
    })
    return await resp.json()
  }

  async function* all(root) {
    const node = await fetchNode(root);
    if (node.type == 'branch') {
      // todo: parallel?
      for (const addr of node.addresses) {
        yield* all(addr)
      }
    } else {
      for (const key of node.keys) {
        yield key
      }
    }
  };

  for await (const val of all(

    "8aa15f17-2369-45a2-af4c-1fd0a727f7c2"
    //"9fa3baff-0ba8-402f-9fdf-35b014331f03"

  )) {
    console.log(val)
  }
</script>
